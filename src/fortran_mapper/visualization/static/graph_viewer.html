<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graph Visualizer - Fortran Mapper</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="loading">
        <div class="spinner"></div>
        <p>Loading graph data...</p>
    </div>
    
    <div id="graph"></div>
    
    <div id="controls">
        <h3>Visualization Controls</h3>
        
        <div class="control-section">
            <label>
                Graph Type:
                <select id="graphType">
                    <option value="overview">Overview</option>
                    <option value="statistics">Statistics</option>
                    <option value="focused">Focused View</option>
                    <option value="neighborhood">Node Neighborhood</option>
                    <option value="filtered">Custom Filters</option>
                </select>
            </label>
        </div>
        
        <div id="focusedControls" class="control-section" style="display: none;">
            <label>
                Node Type:
                <select id="nodeType">
                    <option value="">Loading...</option>
                </select>
            </label>
            <label>
                Relationship:
                <select id="relationType">
                    <option value="">All</option>
                </select>
            </label>
        </div>
        
        <div id="neighborhoodControls" class="control-section" style="display: none;">
            <label>
                Node Search:
                <input type="text" id="nodeSearch" placeholder="Search nodes...">
                <div id="searchResults"></div>
            </label>
            <label>
                Depth:
                <input type="number" id="depth" value="2" min="1" max="5">
            </label>
        </div>
        
        <div id="filteredControls" class="control-section" style="display: none;">
            <label>
                Node Types:
                <div id="nodeTypeCheckboxes">
                    <!-- Populated dynamically -->
                </div>
            </label>
            <label style="margin-top: 10px;">
                Relationship Types:
                <div id="relationshipTypeCheckboxes">
                    <!-- Populated dynamically -->
                </div>
            </label>
            <label style="margin-top: 10px;">
                <input type="checkbox" id="connectedOnly" checked> Show only connected nodes
            </label>
        </div>
        
        <div class="control-section">
            <label>
                Max Nodes:
                <input type="number" id="maxNodes" value="500" min="100" max="2000" step="100">
            </label>
        </div>
        
        <div class="control-section">
            <label>
                Color By:
                <select id="colorBy">
                    <option value="type">Node Type</option>
                    <option value="connectivity">Connectivity</option>
                    <option value="custom">Custom Property</option>
                </select>
            </label>
            
            <label id="customPropertyControl" style="display: none;">
                Property:
                <select id="customProperty">
                    <option value="">Select property...</option>
                </select>
            </label>
        </div>
        
        <div class="control-section">
            <label>
                Node Size:
                <select id="sizeBy">
                    <option value="uniform">Uniform</option>
                    <option value="degree">By Connectivity</option>
                    <option value="property">By Property</option>
                </select>
            </label>
            
            <label id="sizePropertyControl" style="display: none;">
                Property:
                <select id="sizeProperty">
                    <option value="">Select property...</option>
                </select>
            </label>
        </div>
        
        <div class="control-section">
            <label>
                Layout:
                <select id="layout">
                    <option value="force">Force-Directed</option>
                    <option value="radial">Radial</option>
                    <option value="hierarchical">Hierarchical</option>
                </select>
            </label>
        </div>
        
        <div class="control-section">
            <label>
                <input type="checkbox" id="showLabels" checked> Show Labels
            </label>
            <label>
                <input type="checkbox" id="showEdgeLabels"> Show Edge Labels
            </label>
        </div>
        
        <div class="control-section">
            <button id="resetView">Reset View</button>
            <button id="exportData">Export Data</button>
            <button id="refreshData">Refresh</button>
        </div>
    </div>
    
    <div id="info">
        <h3>Graph Information</h3>
        <div id="graphStats">
            <p>Nodes: <span id="nodeCount">0</span></p>
            <p>Edges: <span id="edgeCount">0</span></p>
            <p>Type: <span id="currentGraphType">-</span></p>
        </div>
        <div id="schemaInfo">
            <h4>Schema</h4>
            <div id="schemaContent">Loading...</div>
        </div>
        <div id="nodeInfo">
            <h4>Selected Node</h4>
            <p style="color: #888;">Click on a node for details</p>
        </div>
    </div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div id="legendContent"></div>
    </div>
    
    <div class="tooltip"></div>
    
    <script src="graph_viewer.js"></script>
</body>
</html>